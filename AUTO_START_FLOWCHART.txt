================================================================================
AUTO-START FLOWCHART - What Happens When Flask Starts
================================================================================

YOU: Double-click start_flask.bat
         â”‚
         â–¼
    Flask starts
         â”‚
         â–¼
    Import ml_automation_service.py
         â”‚
         â–¼
    Call init_automation_service()
         â”‚
         â–¼
    Check: Does ml_automation_state.json exist?
         â”‚
         â”œâ”€ NO (First Run)
         â”‚     â”‚
         â”‚     â–¼
         â”‚  Print: "First run detected - ENABLING automation at 18:00"
         â”‚     â”‚
         â”‚     â–¼
         â”‚  Create APScheduler background thread
         â”‚     â”‚
         â”‚     â–¼
         â”‚  Add job: run_daily_cycle() at 18:00 daily
         â”‚     â”‚
         â”‚     â–¼
         â”‚  Start scheduler
         â”‚     â”‚
         â”‚     â–¼
         â”‚  Save state: { "enabled": true, "schedule_time": "18:00" }
         â”‚     â”‚
         â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚
         â””â”€ YES (Previous Run)   â”‚
               â”‚                 â”‚
               â–¼                 â”‚
            Check: Was it enabled before?
               â”‚                 â”‚
               â”œâ”€ YES            â”‚
               â”‚  â”‚              â”‚
               â”‚  â–¼              â”‚
               â”‚ Print: "Restoring automation from previous state"
               â”‚  â”‚              â”‚
               â”‚  â–¼              â”‚
               â”‚ Start scheduler with saved time
               â”‚  â”‚              â”‚
               â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
               â”‚                 â”‚
               â””â”€ NO             â”‚
                  â”‚              â”‚
                  â–¼              â”‚
                Print: "Automation manually disabled - staying off"
                  â”‚              â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                 â”‚
                                 â–¼
                        Flask fully started
                                 â”‚
                                 â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  AUTOMATION RUNNING!        â”‚
                   â”‚  Status: ENABLED            â”‚
                   â”‚  Schedule: Daily at 18:00   â”‚
                   â”‚  Next Run: Today/Tomorrow   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                                 â”‚
         â–¼                                                 â–¼
    WAIT FOR 6 PM                                  USER OPENS BROWSER
         â”‚                                                 â”‚
         â”‚                                                 â–¼
         â”‚                                    http://127.0.0.1:5000/ml-trading
         â”‚                                                 â”‚
         â”‚                                                 â–¼
         â”‚                                         Clicks: âš™ï¸ Status
         â”‚                                                 â”‚
         â”‚                                                 â–¼
         â”‚                                         Shows: âœ… AUTOMATION ENABLED
         â”‚                                                 Schedule: 18:00 (daily)
         â”‚                                                 Next Run: Today at 6 PM
         â”‚
         â–¼
    CLOCK HITS 6:00 PM
         â”‚
         â–¼
    APScheduler triggers run_daily_cycle()
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ AUTOMATED ML CYCLE STARTS               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ Step 1: Market Scan (1-2 min)
         â”‚     â”œâ”€ Scan 50 stocks from S&P 500
         â”‚     â”œâ”€ Scan 10+ crypto symbols
         â”‚     â”œâ”€ Run 4 analyzers on each
         â”‚     â”œâ”€ Combine with ML predictions
         â”‚     â””â”€ Generate 30-50 signals
         â”‚
         â”œâ”€ Step 2: Check Outcomes (30 sec)
         â”‚     â”œâ”€ Load open positions
         â”‚     â”œâ”€ Check current prices
         â”‚     â”œâ”€ Mark wins (â‰¥+2%) vs losses
         â”‚     â””â”€ Record to database
         â”‚
         â”œâ”€ Step 3: Simulate New Trades (30 sec)
         â”‚     â”œâ”€ Filter to bullish signals
         â”‚     â”œâ”€ Take top 10 by score
         â”‚     â””â”€ Record entry prices
         â”‚
         â””â”€ Step 4: Retrain Model (if â‰¥10 trades)
               â”œâ”€ Load all trades from database
               â”œâ”€ Train Random Forest
               â”œâ”€ Save improved model
               â””â”€ Model gets smarter!
         â”‚
         â–¼
    Update last_run timestamp in state file
         â”‚
         â–¼
    Wait 24 hours â†’ Repeat at 6 PM tomorrow
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                â”‚
                                                â–¼
                                    CYCLE REPEATS DAILY FOREVER
                                    (or until you click Stop Auto)


================================================================================
KEY POINTS
================================================================================

âœ… Automation STARTS AUTOMATICALLY on first Flask run
âœ… NO clicking "Start Auto" button needed
âœ… Default schedule: 6:00 PM (18:00) daily
âœ… Persists across Flask restarts
âœ… Runs inside Flask - no external scheduler
âœ… Works on ANY hosting platform

BUTTONS ARE FOR MANUAL CONTROL ONLY:
- âš™ï¸ Status       â†’ Check if running (will show "ENABLED")
- â–¶ï¸ Start Auto   â†’ Change schedule time or restart if stopped
- â¸ï¸ Stop Auto    â†’ Disable daily automation (manual runs only)
- ğŸš€ Run Full Cycle â†’ Run immediately (don't wait for 6 PM)

================================================================================
STATE FILE EXAMPLES
================================================================================

FIRST RUN (Fresh Install):
File: backend/data/ml_automation_state.json
{
  "enabled": true,
  "schedule_time": "18:00",
  "last_run": null,
  "next_run": "2025-12-15T18:00:00"
}

AFTER FIRST CYCLE:
{
  "enabled": true,
  "schedule_time": "18:00",
  "last_run": "2025-12-15T18:00:32",
  "next_run": "2025-12-16T18:00:00"
}

MANUALLY STOPPED:
{
  "enabled": false,
  "schedule_time": "18:00",
  "last_run": "2025-12-15T18:00:32",
  "next_run": null
}

CUSTOM TIME (9 AM):
{
  "enabled": true,
  "schedule_time": "09:00",
  "last_run": "2025-12-15T09:00:15",
  "next_run": "2025-12-16T09:00:00"
}

================================================================================
CONSOLE OUTPUT ON FLASK START
================================================================================

$ start_flask.bat

[ML AUTOMATION] Initializing built-in scheduler...
[ML AUTOMATION] First run detected - ENABLING automation by default at 18:00 (6 PM)
âœ… ML Automation STARTED - Will run daily at 18:00
Next run: 2025-12-15T18:00:00
[ML AUTOMATION] Ready
Flask server starting on http://127.0.0.1:5000
Logging: QUIET MODE (errors only)

â† This confirms automation is running!

================================================================================
YOU DON'T NEED TO DO ANYTHING!
================================================================================

Just start Flask:
  start_flask.bat

System is now:
  âœ… Running automatically
  âœ… Will scan at 6 PM today
  âœ… Will learn and improve
  âœ… Requires NO clicking!

That's it! ğŸš€
